Teniendo en cuenta los puntos de la prueba comparto la 
solucion nueva con las respectivas validaciones.

visual studio 2022
sql server 2019
